# üìò PetCare Tracker ‚Äî Estructura de Datos

Este documento describe la estructura de tablas y los tipos de datos usados en el backend (Google Sheets o base de datos equivalente).  
Los tipos de datos est√°n pensados para compatibilidad con Google Sheets y posible migraci√≥n a una base SQL.

---

## üêæ `pets`

| Columna        | Tipo de dato | Descripci√≥n |
|----------------|---------------|--------------|
| `pet_id`       | STRING (UUID) | Identificador √∫nico de la mascota |
| `user_id`      | STRING        | Usuario propietario |
| `name`         | STRING        | Nombre de la mascota |
| `image_url`    | STRING (URL)  | Enlace a la imagen almacenada (Firebase Storage) |
| `species`      | STRING        | Especie (perro, gato, etc.) |
| `sex`          | STRING        | Sexo de la mascota |
| `breed`        | STRING        | Raza |
| `date_of_birth`| DATE          | Fecha de nacimiento |
| `weight_kg`    | NUMBER (FLOAT)| Peso en kilogramos |
| `color`        | STRING        | Color principal |
| `created_at`   | DATETIME      | Fecha de creaci√≥n del registro |

---

## üóìÔ∏è `routines`

| Columna                | Tipo de dato | Descripci√≥n |
|------------------------|---------------|--------------|
| `routine_id`           | STRING (UUID) | Identificador √∫nico de rutina |
| `user_id`              | STRING        | Usuario propietario |
| `routine_name`         | STRING        | Nombre de la rutina (ej. "Cepillado", "Ba√±o") |
| `start_of_activity`    | DATETIME      | Fecha/hora inicial de la rutina |
| `perform_every_number` | NUMBER        | Intervalo num√©rico (ej. cada 2 d√≠as) |
| `perform_every_unit`   | STRING (enum) | Unidad del intervalo (`days`, `weeks`, `months`, `hours`) |
| `next_activity`        | DATETIME      | Pr√≥xima ejecuci√≥n (calculado autom√°ticamente) |
| `created_at`           | DATETIME      | Fecha de creaci√≥n de la rutina |

---

## üîÅ `routineassignments`

| Columna             | Tipo de dato | Descripci√≥n |
|---------------------|---------------|--------------|
| `assignment_id`     | STRING (UUID) | Identificador √∫nico del v√≠nculo |
| `routine_id`        | STRING        | ID de la rutina asignada |
| `pet_id`            | STRING        | ID de la mascota asignada |
| `user_id`           | STRING        | Usuario propietario |
| `assigned_at`       | DATETIME      | Fecha en que se asign√≥ la rutina |
| `last_performed_at` | DATETIME      | √öltima vez que se marc√≥ como realizada |
| `next_activity`     | DATETIME      | Pr√≥xima fecha calculada tras marcar como realizada |

---

## üíä `medications`

| Columna                | Tipo de dato | Descripci√≥n |
|------------------------|---------------|--------------|
| `medication_id`        | STRING (UUID) | Identificador √∫nico del medicamento |
| `user_id`              | STRING        | Usuario propietario |
| `medication_name`      | STRING        | Nombre del medicamento |
| `start_of_supply`      | DATETIME      | Inicio del suministro |
| `perform_every_number` | NUMBER        | Intervalo entre dosis |
| `perform_every_unit`   | STRING (enum) | Unidad (`hours`, `days`, `weeks`) |
| `dose_number`          | NUMBER        | Cantidad por dosis |
| `dose_unit`            | STRING        | Unidad de dosis (`ml`, `mg`, etc.) |
| `end_of_supply`        | DATETIME      | Fecha estimada de finalizaci√≥n |
| `next_supply`          | DATETIME      | Pr√≥xima dosis o recarga |
| `created_at`           | DATETIME      | Fecha de creaci√≥n |

---

## üíä‚ûï `medicationassignments`

| Columna         | Tipo de dato | Descripci√≥n |
|-----------------|---------------|--------------|
| `assignment_id` | STRING (UUID) | Identificador √∫nico |
| `medication_id` | STRING        | Medicamento asignado |
| `pet_id`        | STRING        | Mascota asignada |
| `user_id`       | STRING        | Usuario propietario |
| `assigned_at`   | DATETIME      | Fecha en que se asign√≥ el medicamento |

*(Opcional para el futuro: agregar `last_given_at` y `next_supply` si deseas que funcione igual que las rutinas.)*

---

## üè• `healthevents`

| Columna                | Tipo de dato | Descripci√≥n |
|------------------------|---------------|--------------|
| `health_id`            | STRING (UUID) | Identificador del evento |
| `pet_id`               | STRING        | Mascota asociada |
| `user_id`              | STRING        | Usuario propietario |
| `event_type`           | STRING (enum) | Tipo de evento (`vet_visit`, `vaccine`, `bath`, etc.) |
| `event_name`           | STRING        | Nombre del evento espec√≠fico |
| `start_of_activity`    | DATETIME      | Fecha/hora del evento |
| `perform_every_number` | NUMBER        | Frecuencia (si aplica) |
| `perform_every_unit`   | STRING        | Unidad de tiempo (`days`, `months`, etc.) |
| `next_activity`        | DATETIME      | Pr√≥xima ocurrencia (si aplica) |
| `notes`                | STRING        | Observaciones |
| `created_at`           | DATETIME      | Fecha de creaci√≥n |

---

## üìú `activitylog`

| Columna        | Tipo de dato | Descripci√≥n |
|----------------|---------------|--------------|
| `log_id`       | STRING (UUID) | Identificador del log |
| `user_id`      | STRING        | Usuario que ejecut√≥ la acci√≥n |
| `pet_id`       | STRING        | Mascota relacionada |
| `action_type`  | STRING (enum) | Tipo de acci√≥n (`perform_routine`, `give_medication`, `add_event`, etc.) |
| `target_table` | STRING        | Tabla afectada (`routines`, `medications`, etc.) |
| `target_id`    | STRING        | ID del registro afectado |
| `timestamp`    | DATETIME      | Fecha/hora del evento |
| `details`      | STRING (JSON) | Detalles adicionales (como nota o par√°metros de la acci√≥n) |

---

## üß† Consideraciones Generales

- **Fechas** se guardan en formato ISO (`YYYY-MM-DDTHH:mm:ssZ`)
- **IDs** generados con `uuid.v4()`
- **Unidades de tiempo** recomendadas: `hours`, `days`, `weeks`, `months`
- **Enum fields** deben validarse en los endpoints
- Cada tabla tiene una columna `created_at` para trazabilidad
- Los c√°lculos de `next_activity` y `next_supply` son autom√°ticos (funciones Cloud `onPerformed`)

---

## üîÑ Automatizaciones futuras

- `onRoutinePerformed`: actualiza `routineassignments.last_performed_at` y recalcula `next_activity`
- `onMedicationPerformed`: hace lo mismo para `medicationassignments`
- Batch diario: revisa y repara fechas pr√≥ximas vencidas

---